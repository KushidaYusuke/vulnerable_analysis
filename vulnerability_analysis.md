# 脆弱性診断


### 診断対象URL一覧

- トップページ　http://www.badstore.net/
- 

## SQLインジェクション(CWE-89: SQL Injection)
1.リスク評価　高
2.発見箇所
http://www.badstore.net/cgi-bin/badstore.cgi

![alt text](image-7.png)

3.脆弱性詳細

クエリに「searchquery=1000'」と入力した結果、DB関係のSQL Syntax errorが表示されたため、SQLインジェクションがあると判断



### HTTPリクエストメッセージ

![alt text](image-8.png)

### HTTPレスポンスメッセージ

![alt text](image-9.png)

- 表示されるエラーメッセージ

![alt text](image-10.png)

4.脆弱性概要


5.対策



##　クロスサイト・スクリプティング
1.リスク評価 中
2.発見箇所
https://www.badstore.net/cgi-bin/badstore.cgi
![alt text](image-7.png)



### 脆弱性詳細

パラメータ「search_query」に```1000<script>alert(1)</script>```と入力した際にエスケープされずに入力したスクリプトが作動した。

### HTTPリスエストメッセージ
![alt text](image-15.png)

### HTTPレスポンスメッセージ(一部)
![alt text](image-16.png)


## コマンドインジェクション

1.リスク評価 高

2.発見箇所
https://www.badstore.net/cgi-bin/badstore.cgi?action=supplierportal
![alt text](image-12.png)


3.脆弱性詳細

パラメーター「viewfilename」に```../../../../../../../bin/sleep 20|```と入力して「Go」ボタンで実行した際にレスポンスが20秒遅れる。

### HTTPリクエストメッセージ

![alt text](image-13.png)

![alt text](image-14.png)





2.発見箇所
https://www.badstore.net/cgi-bin/badstore.cgi?action=loginregister
![alt text](image-17.png)























































































+++






　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　